import{_ as A,u as B,g as u,l as j,f as I,m as S,c as d,a as t,d as c,h as r,v as p,n as U,t as f,i as N,p as T,F,r as V,e as $,o as g,q as O,s as H}from"./BLCsiHop.js";import{u as Q}from"./5MkyaSeB.js";const G={class:"flex items-center justify-center mt-16 py-2"},J={class:"relative w-full max-w-md"},K={key:0,class:"fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-50"},W={class:"modal-content bg-white rounded-lg p-6 w-full max-w-lg shadow-lg fixed top-8"},X={class:"font-semibold mb-4 flex flex-row-reverse items-center gap-2"},Y=["value"],Z={class:"flex items-center gap-4"},ee={key:0,class:"w-16 h-16 overflow-hidden rounded-md border"},te=["src"],le={class:"flex flex-col gap-2 mt-4"},se={type:"submit",class:"bg-blue-500 text-white rounded-lg py-2 px-4 hover:bg-blue-600 transition w-full flex flex-row-reverse items-center justify-center gap-2"},oe={class:"mt-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 py-4 px-3"},re={class:"relative w-full h-40 mb-4"},ae=["src","alt"],ne={class:"text-lg font-semibold mb-2 text-center"},ie={class:"text-gray-600 text-center"},ue={class:"text-gray-600 text-center"},de={class:"text-sm text-gray-500 mt-2 text-center"},ce={class:"flex mt-4 gap-2 w-full justify-center"},pe=["onClick"],fe=["onClick"],ge={__name:"products-management",setup(me){Q({link:[{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"}]});const h=H(),{$axios:m}=B(),a=u([]),_=u([]),o=u({name:"",sku:"",image:"",price:"",discount:"",stock:"",description:"",category_id:""}),n=u(!1),v=u(null),y=u(!1),P=j(()=>o.value.image instanceof File?URL.createObjectURL(o.value.image):o.value.image);I();const w=u(""),L=j(()=>{const l=w.value.toLowerCase();return a.value.filter(e=>e.name.toLowerCase().includes(l)||e.sku.toLowerCase().includes(l)||e.description.toLowerCase().includes(l))});async function M(){try{const l=await m.get("product/list");a.value=l.data.data}catch(l){console.error("Fetch products error:",l.response?l.response.data:l)}}async function q(){try{const l=await m.get("category/list");_.value=l.data.data}catch(l){console.error("Fetch categories error:",l.response?l.response.data:l)}}async function D(){try{const l=new FormData,e={...o.value};e.category_id=o.value.category_id,delete e.category,Object.keys(e).forEach(i=>{l.append(i,e[i])});const s=await m.post("product/create",l,{headers:{"Content-Type":"multipart/form-data"}});a.value.push(s.data.data),x(),window.location.reload()}catch(l){console.error("Create product error:",l.response?l.response.data:l)}}async function E(){try{const l=new FormData,e={...o.value};e.category_id=o.value.category_id,delete e.category,Object.keys(e).forEach(b=>{l.append(b,e[b])});const s=await m.post(`product/update/${v.value}`,l,{headers:{"Content-Type":"multipart/form-data"}}),i=a.value.findIndex(b=>b.id===v.value);i!==-1&&(a.value[i]=s.data.data),x(),window.location.reload()}catch(l){console.error("Update product error:",l.response?l.response.data:l)}}async function R(l){try{await m.delete(`product/delete/${l}`),a.value=a.value.filter(e=>e.id!==l)}catch(e){console.error("Delete product error:",e.response?e.response.data:e)}}function k(l,e=null){if(l==="edit"){if(!e){console.error("Product is null or undefined.");return}o.value={...e},v.value=e.id,n.value=!0,o.value.image=e.image?`${h.public.API_BASE_URL}${e.image.path}`:null}else C(),n.value=!1;y.value=!0}function x(){C(),y.value=!1}function C(){o.value={name:"",sku:"",image:"",price:"",discount:"",stock:"",description:"",category_id:""},v.value=null}function z(l){const e=l.target.files[0];e&&(o.value.image=e)}return S(()=>{M(),q()}),(l,e)=>(g(),d("div",null,[e[16]||(e[16]=t("div",{class:"fixed top-0 right-0 w-full flex flex-row-reverse items-center bg-blue-600 text-white py-3 px-4 z-50"},[t("h1",{class:"text-lg font-bold flex items-center gap-2 py-1 px-3 rounded-lg"},[c(" مدیریت محصولات "),t("i",{class:"fas fa-box"})])],-1)),t("div",G,[t("div",J,[r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s),type:"text",placeholder:"جستجوی محصول...",class:"border rounded-lg p-3 w-full focus:outline-blue-500 text-right bg-white text-black shadow-sm",dir:"rtl"},null,512),[[p,w.value]]),e[10]||(e[10]=t("i",{class:"fas fa-search absolute top-1/2 left-3 transform -translate-y-1/2 text-gray-500"},null,-1))])]),y.value?(g(),d("div",K,[t("div",W,[t("button",{onClick:x,class:"absolute top-3 left-3 text-gray-500 hover:text-gray-700"},e[11]||(e[11]=[t("i",{class:"fas fa-times text-lg"},null,-1)])),t("h2",X,[t("i",{class:U(n.value?"fas fa-edit text-yellow-500":"fas fa-plus-circle text-blue-500")},null,2),c(" "+f(n.value?"ویرایش محصول":"افزودن محصول جدید"),1)]),t("form",{onSubmit:e[8]||(e[8]=N(s=>n.value?E():D(),["prevent"])),class:"flex flex-col gap-4"},[r(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.name=s),type:"text",placeholder:"نام محصول",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[p,o.value.name]]),r(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.sku=s),type:"text",placeholder:"کد محصول",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[p,o.value.sku]]),r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.price=s),type:"number",placeholder:"قیمت محصول",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[p,o.value.price]]),r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.discount=s),type:"number",placeholder:"تخفیف",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[p,o.value.discount]]),r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.stock=s),type:"number",placeholder:"موجودی محصول",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[p,o.value.stock]]),r(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.description=s),placeholder:"توضیحات",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[p,o.value.description]]),r(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>o.value.category_id=s),class:"border rounded-lg p-2 focus:outline-blue-500",dir:"rtl"},[(g(!0),d(F,null,V(_.value,s=>(g(),d("option",{key:s.id,value:s.id},f(s.name),9,Y))),128))],512),[[T,o.value.category_id]]),t("div",Z,[t("input",{type:"file",accept:"image/*",onChange:z,class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,32),o.value.image?(g(),d("div",ee,[t("img",{src:P.value,alt:"پیش‌نمایش",class:"object-cover w-full h-full"},null,8,te)])):$("",!0)]),t("div",le,[t("button",se,[t("i",{class:U(n.value?"fas fa-save":"fas fa-check-circle")},null,2),c(" "+f(n.value?"ویرایش محصول":"ایجاد محصول"),1)]),t("button",{type:"button",onClick:x,class:"bg-gray-500 text-white rounded-lg py-2 px-4 hover:bg-gray-600 transition w-full flex flex-row-reverse items-center justify-center gap-2"},e[12]||(e[12]=[t("i",{class:"fas fa-ban"},null,-1),c(" لغو ")]))])],32)])])):$("",!0),t("div",null,[t("div",oe,[t("div",{class:"border text-amber-50 rounded-lg shadow-md p-4 gap-4 bg-emerald-600 flex items-center justify-center cursor-pointer hover:bg-cyan-950 transition",onClick:e[9]||(e[9]=s=>k("create"))},e[13]||(e[13]=[c(" افزودن محصول جدید "),t("i",{class:"fas fa-plus text-amber-50 text-2xl"},null,-1)])),(g(!0),d(F,null,V(L.value,s=>(g(),d("div",{key:s.id,class:"border rounded-lg shadow-md p-6 flex flex-col items-center justify-between"},[t("div",re,[t("img",{src:s.image?`${O(h).public.API_BASE_URL}${s.image.path}`:"/default-product-image.jpg",alt:s.name,class:"object-cover w-full h-full rounded-md"},null,8,ae)]),t("h2",ne,f(s.name),1),t("p",ie,"قیمت: "+f(s.price)+" تومان",1),t("p",ue,"موجودی: "+f(s.stock),1),t("p",de,f(s.description),1),t("div",ce,[t("button",{onClick:i=>k("edit",s),class:"bg-yellow-500 text-white rounded-lg py-2 px-3 hover:bg-yellow-600 transition w-full max-w-xs flex items-center justify-center flex-row-reverse gap-2"},e[14]||(e[14]=[t("i",{class:"fas fa-edit"},null,-1),c(" ویرایش ")]),8,pe),t("button",{onClick:i=>R(s.id),class:"bg-red-500 text-white rounded-lg py-2 px-3 hover:bg-red-600 transition w-full max-w-xs flex items-center justify-center flex-row-reverse gap-2"},e[15]||(e[15]=[t("i",{class:"fas fa-trash"},null,-1),c(" حذف ")]),8,fe)])]))),128))])])]))}},be=A(ge,[["__scopeId","data-v-f5611d79"]]);export{be as default};
