import{u as I,g as i,s as P,f as N,l as T,c as d,b as O,a as t,d as u,h as a,v as c,n as V,t as p,i as H,x as Q,F as _,r as F,e as L,o as f,y,z as G,p as J}from"./DzWFj6i5.js";import{u as K}from"./DRV8-qG1.js";import{_ as W}from"./DlAUqK2U.js";const X={class:"body"},Y={class:"flex items-center justify-center mt-16 py-2"},Z={class:"relative w-full max-w-md"},ee={key:0,class:"fixed inset-0 bg-gray-800 bg-opacity-50 flex justify-center items-center z-50"},te={class:"modal-content bg-white rounded-lg p-6 w-full max-w-lg shadow-lg fixed top-8"},se={class:"font-semibold mb-4 flex flex-row-reverse items-center gap-2"},le=["value"],oe={class:"flex items-center gap-4"},ae={key:0,class:"w-16 h-16 overflow-hidden rounded-md border"},re=["src"],ne={class:"flex flex-col gap-2 mt-4"},ie={type:"submit",class:"bg-blue-500 text-white rounded-lg py-2 px-4 hover:bg-blue-600 transition w-full flex flex-row-reverse items-center justify-center gap-2"},de={class:"mt-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 py-4 px-3"},ue={class:"relative h-40 mb-4"},ce=["src","alt"],pe={class:"text-lg font-semibold mb-2 text-center"},fe={class:"text-gray-600 text-center"},ge={class:"text-gray-600 text-center"},me={class:"text-sm text-gray-500 mt-2 text-center"},ve={class:"flex mt-4 gap-2 w-full justify-center"},xe=["onClick"],be=["onClick"],ye={__name:"products-management",setup(he){K({link:[{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"}]});const k=G(),{$axios:m,$toPersian:C,$formatPrice:M}=I(),r=i([]),j=i([]),o=i({name:"",sku:"",image:"",price:"",discount:"",stock:"",description:"",category_id:""}),n=i(!1),x=i(null),h=i(!1),D=P(()=>o.value.image instanceof File?URL.createObjectURL(o.value.image):o.value.image);N();const w=i(""),q=P(()=>{const l=w.value.toLowerCase();return r.value.filter(e=>e.name.toLowerCase().includes(l)||e.description.toLowerCase().includes(l))});async function z(){try{const l=await m.get("product/list");r.value=l.data.data}catch(l){console.error("Fetch products error:",l.response?l.response.data:l)}}async function B(){try{const l=await m.get("category/list");j.value=l.data.data}catch(l){console.error("Fetch categories error:",l.response?l.response.data:l)}}async function E(){try{const l=new FormData,e={...o.value};e.category_id=o.value.category_id,delete e.category,Object.keys(e).forEach(s=>{l.append(s,e[s])});const v=await m.post("product/create",l,{headers:{"Content-Type":"multipart/form-data"}});r.value.push(v.data.data),b(),window.location.reload()}catch(l){console.error("Create product error:",l.response?l.response.data:l)}}async function R(){try{const l=new FormData,e={...o.value};e.category_id=o.value.category_id,delete e.category,Object.keys(e).forEach(g=>{l.append(g,e[g])});const v=await m.post(`product/update/${x.value}`,l,{headers:{"Content-Type":"multipart/form-data"}}),s=r.value.findIndex(g=>g.id===x.value);s!==-1&&(r.value[s]=v.data.data),b(),window.location.reload()}catch(l){console.error("Update product error:",l.response?l.response.data:l)}}async function S(l){try{await m.delete(`product/delete/${l}`),r.value=r.value.filter(e=>e.id!==l)}catch(e){console.error("Delete product error:",e.response?e.response.data:e)}}function U(l,e=null){if(l==="edit"){if(!e){console.error("Product is null or undefined.");return}o.value={...e},x.value=e.id,n.value=!0,o.value.image=e.image?`${k.public.API_BASE_URL}${e.image.path}`:null}else $(),n.value=!1;h.value=!0}function b(){$(),h.value=!1}function $(){o.value={name:"",sku:"",image:"",price:"",discount:"",stock:"",description:"",category_id:""},x.value=null}function A(l){const e=l.target.files[0];e&&(o.value.image=e)}return T(()=>{z(),B()}),(l,e)=>{const v=J;return f(),d(_,null,[O(v),t("div",X,[e[16]||(e[16]=t("div",{class:"fixed top-0 right-0 w-full flex flex-row-reverse items-center bg-blue-600 text-white py-3 px-4 z-50"},[t("h1",{class:"text-lg font-bold flex items-center gap-2 py-1 px-3 rounded-lg"},[u(" مدیریت محصولات "),t("i",{class:"fas fa-box"})])],-1)),t("div",Y,[t("div",Z,[a(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s),type:"text",placeholder:"جستجوی محصول...",class:"border rounded-lg p-3 w-full focus:outline-blue-500 text-right bg-white text-black shadow-sm",dir:"rtl"},null,512),[[c,w.value]]),e[10]||(e[10]=t("i",{class:"fas fa-search absolute top-1/2 left-3 transform -translate-y-1/2 text-gray-500"},null,-1))])]),h.value?(f(),d("div",ee,[t("div",te,[t("button",{onClick:b,class:"absolute top-3 left-3 text-gray-500 hover:text-gray-700"},e[11]||(e[11]=[t("i",{class:"fas fa-times text-lg"},null,-1)])),t("h2",se,[t("i",{class:V(n.value?"fas fa-edit text-yellow-500":"fas fa-plus-circle text-blue-500")},null,2),u(" "+p(n.value?"ویرایش محصول":"افزودن محصول جدید"),1)]),t("form",{onSubmit:e[8]||(e[8]=H(s=>n.value?R():E(),["prevent"])),class:"flex flex-col gap-4"},[a(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.name=s),type:"text",placeholder:"نام محصول",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[c,o.value.name]]),a(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.sku=s),type:"text",placeholder:"کد محصول",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[c,o.value.sku]]),a(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.price=s),type:"number",placeholder:"قیمت محصول",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[c,o.value.price]]),a(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.discount=s),type:"number",placeholder:"تخفیف",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[c,o.value.discount]]),a(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.stock=s),type:"number",placeholder:"موجودی محصول",required:"",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[c,o.value.stock]]),a(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.description=s),placeholder:"توضیحات",class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,512),[[c,o.value.description]]),a(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>o.value.category_id=s),class:"border rounded-lg p-2 focus:outline-blue-500",dir:"rtl"},[(f(!0),d(_,null,F(j.value,s=>(f(),d("option",{key:s.id,value:s.id},p(s.name),9,le))),128))],512),[[Q,o.value.category_id]]),t("div",oe,[t("input",{type:"file",accept:"image/*",onChange:A,class:"border rounded-lg p-2 focus:outline-blue-500 text-right",dir:"rtl"},null,32),o.value.image?(f(),d("div",ae,[t("img",{src:D.value,alt:"پیش‌نمایش",class:"object-cover w-full h-full"},null,8,re)])):L("",!0)]),t("div",ne,[t("button",ie,[t("i",{class:V(n.value?"fas fa-save":"fas fa-check-circle")},null,2),u(" "+p(n.value?"ویرایش محصول":"ایجاد محصول"),1)]),t("button",{type:"button",onClick:b,class:"bg-gray-500 text-white rounded-lg py-2 px-4 hover:bg-gray-600 transition w-full flex flex-row-reverse items-center justify-center gap-2"},e[12]||(e[12]=[t("i",{class:"fas fa-ban"},null,-1),u(" لغو ")]))])],32)])])):L("",!0),t("div",null,[t("div",de,[t("div",{class:"border text-amber-50 rounded-lg shadow-md p-4 gap-4 bg-emerald-600 flex items-center justify-center cursor-pointer hover:bg-cyan-950 transition",onClick:e[9]||(e[9]=s=>U("create"))},e[13]||(e[13]=[u(" افزودن محصول جدید "),t("i",{class:"fas fa-plus text-amber-50 text-2xl"},null,-1)])),(f(!0),d(_,null,F(q.value,s=>(f(),d("div",{key:s.id,class:"border rounded-lg shadow-md p-6 flex flex-col items-center justify-between"},[t("div",ue,[t("img",{src:s.image?`${y(k).public.API_BASE_URL}${s.image.path}`:"/default-product-image.jpg",alt:s.name,class:"object-cover h-full rounded-md"},null,8,ce)]),t("h2",pe,p(s.name),1),t("p",fe,"قیمت: "+p(y(C)(y(M)(s.price)))+" تومان",1),t("p",ge,"موجودی: "+p(y(C)(s.stock)),1),t("p",me,p(s.description),1),t("div",ve,[t("button",{onClick:g=>U("edit",s),class:"bg-yellow-500 text-white rounded-lg py-2 px-3 hover:bg-yellow-600 transition w-full max-w-xs flex items-center justify-center flex-row-reverse gap-2"},e[14]||(e[14]=[t("i",{class:"fas fa-edit"},null,-1),u(" ویرایش ")]),8,xe),t("button",{onClick:g=>S(s.id),class:"bg-red-500 text-white rounded-lg py-2 px-3 hover:bg-red-600 transition w-full max-w-xs flex items-center justify-center flex-row-reverse gap-2"},e[15]||(e[15]=[t("i",{class:"fas fa-trash"},null,-1),u(" حذف ")]),8,be)])]))),128))])])])],64)}}},Ce=W(ye,[["__scopeId","data-v-ec5aa845"]]);export{Ce as default};
