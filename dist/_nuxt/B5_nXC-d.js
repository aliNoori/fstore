import{_ as ve}from"./B8GqyWWX.js";import{_ as pe,f as _e,g as c,u as me,m as he,c as a,a as e,F as h,r as g,e as p,d as y,t as n,q as l,n as f,o as r,b as ge,w as ye,i as G,h as q,j as E,s as fe}from"./wQSAnX_e.js";const ke={class:"progress-container"},be={class:"steps-wrapper"},Ce={class:"step-name"},we={class:"step-content"},$e={key:0,class:"page card"},Se={class:"items"},Pe={class:"image"},Oe=["src","alt"],Ae={class:"product-details"},Ne={class:"product-name"},Fe={class:"product-price"},Ie={class:"product-quantity"},Ue={class:"buttons"},qe=["onClick"],Ee={class:"controls"},Le={key:1,class:"page addresses"},Me={id:"address-selection-page"},Be={class:"address-cards-container"},Re=["onClick"],Ve={class:"address-content"},We={class:"address-buttons"},je=["onClick"],xe=["onClick"],De={class:"controls"},Je={key:2,class:"page shipping-methods"},Te={id:"shipping-method-selection-page"},ze={class:"shipping-cards-container"},Ge=["onClick"],He=["value"],Ke={key:0,class:"checkmark-shipping"},Qe={class:"controls"},Xe={key:3,class:"page invoice"},Ye={class:"body"},Ze={key:0},et={class:"invoice-container"},tt={class:"invoice-header"},st={class:"user-details"},ot={class:"invoice-items"},nt=["src","alt"],lt={key:0},at={class:"invoice-summary"},rt={class:"total"},it={class:"controls"},dt={key:4,class:"page payment"},ct={id:"payment-method-selection-page"},ut={class:"payment-cards-container"},vt=["onClick"],pt=["value"],_t={class:"header-payment-card"},mt=["src","alt"],ht={key:0},gt={key:1},yt={key:0,class:"checkmark"},ft={class:"controls"},kt={key:5},bt={class:"page online-payment-methods"},Ct={id:"online-method-selection-page"},wt={class:"online-cards-container"},$t=["onClick"],St=["value"],Pt=["src","alt"],Ot={key:0,class:"checkmark"},At={class:"controls"},Nt={key:6},Ft={class:"page offline-payment-methods"},It={class:"offline-method-selection-page"},Ut={class:"wallet-card-container"},qt={class:"coupons-card-container"},Et=["onClick"],Lt={class:"coupon-header"},Mt={class:"coupon-title"},Bt={class:"coupon-date"},Rt={class:"coupon-body"},Vt={class:"coupon-footer"},Wt={class:"coupon-status"},jt={class:"controls"},xt={__name:"steps-to-order",setup(Dt){const L=_e(),N=[{number:1,name:"سبد"},{number:2,name:"آدرس"},{number:3,name:"ارسال"},{number:4,name:"فاکتور"},{number:5,name:"درگاه"},{number:6,name:"پرداخت"}],u=c(1),k=()=>{u.value<N.length&&u.value++},$=()=>{u.value>1&&u.value--},H=o=>o==="Online"?"آنلاین":o==="Wallet"?"کیف پول":o==="OtherWays"?"از طرق دیگر":o,K=o=>o==="Online"?"پرداخت از طریق درگاه های بانکی":o==="Wallet"?"پرداخت از طریق کیف پول":o==="OtherWays"?"پرداخت از طریق کارت جایزه و ...":o,{$axios:v,$toPersian:i,$toPersianDate:M,$formatPrice:_}=me(),S=c({}),B=fe(),Q=async()=>{try{const o=await v.get("cart/items/show");S.value=o.data}catch(o){console.error("Error fetching cart items:",o)}},X=async o=>{try{(await v.post(`cart/item/remove/${o}`)).status===200?S.value.cart.items.forEach(O=>{O.product.id===o&&(O.quantity>1?O.quantity--:S.value.cart.items=S.value.cart.items.filter(t=>t.product.id!==o))}):alert("Error removing the item from the cart.")}catch(s){console.error("Error removing from cart:",s)}},R=c([]),Y=async()=>{try{const o=await v.get("user/addresses");R.value=o.data.addresses}catch(o){console.error("Failed to load addresses:",o)}},P=c(null),V=c([]),Z=async()=>{if(!P.value){console.error("No address selected");return}try{const o=await v.post(`user/create/order/${P.value}`);V.value=o.data.order,localStorage.setItem("order_number",JSON.stringify(V.value.order_number)),console.log("Address added to order:",o.data.order)}catch(o){console.error("Failed to add address to order:",o)}},ee=o=>{L.push(`/edit-address/${o}`)},te=o=>{P.value=o,console.log(`آدرس با شناسه ${o} انتخاب شد.`)},se=async()=>{await L.push("/add-new-address")},W=c([]),b=c(null),oe=async()=>{try{const o=await v.get("/shippingMethod/list");W.value=o.data.shippingMethods}catch(o){console.error("Failed to load shippingMethods:",o)}},ne=async()=>{if(!b.value){console.error("No shippingMethod selected");return}try{const o=JSON.parse(localStorage.getItem("order_number")),s=await v.post(`user/addShipping/${b.value}/order/${o}`);console.log("ShippingMethod added to order:",s.data)}catch(o){console.error("Failed to add shippingMethod to order:",o)}},m=c({}),F=c(!0),I=c({}),le=async()=>{try{const o=JSON.parse(localStorage.getItem("order_number")),s=await v.get(`invoice/create/${o}`);m.value=s.data.invoice}catch(o){console.error("Invoice error:",o.response?o.response.data:o)}finally{F.value=!1}},ae=async()=>{try{const o=await v.get("user/profile");I.value=o.data,F.value=!1}catch(o){console.error("Fetch user error:",o.response?o.response.data:o)}},U=c(null),j=c([]),C=c(null),re=async()=>{try{const o=await v.get("/paymentMethod/list");j.value=o.data.paymentMethods}catch(o){console.error("Failed to load shippingMethods:",o)}},ie=async()=>{if(!C.value){console.error("No shippingMethod selected");return}try{const o=await v.post(`user/manageSelectedPayment/${C.value}`);console.log(o.data.action),console.log("PaymentMethod :",o.data.action),U.value=o.data.action,o.data.action==="Online"?await de():o.data.action==="Offline"&&(await ce(),await ue())}catch(o){console.error("Failed to selected paymentMethod :",o)}},x=c([]),w=c(null),de=async()=>{try{const o=await v.get("/onlineMethodGateway/list");x.value=o.data.onlinePaymentMethods}catch(o){console.error("Failed to load onlineMethods:",o)}},D=async()=>{if(!w.value){console.error("No OnlineMethod selected");return}try{const o=JSON.parse(localStorage.getItem("order_number")),s=await v.post(`user/processPayment/${o}/${w.value}`);console.log("url :",s.data.url),window.location.href=s.data.url}catch(o){console.error("Failed to selected onlinePaymentMethods :",o)}},A=c({}),J=c({}),T=c(null),z=c(null),ce=async()=>{try{const o=await v.get("user/my/wallet");A.value=o.data.wallet}catch(o){console.error("خطا در دریافت اطلاعات کیف پول:",o)}},ue=async()=>{try{const o=await v.get("user/my/coupons");J.value=o.data.coupons}catch(o){console.error("خطا در دریافت اطلاعات  کپن های کاربر:",o)}};return he(()=>{Q()}),(o,s)=>{const O=ve;return r(),a(h,null,[e("div",ke,[e("div",be,[(r(),a(h,null,g(N,(t,d)=>e("div",{key:d,class:"step-container"},[e("div",{class:f(["step-circle",{"step-active":d+1<=u.value},{"step-raised":d+1===u.value}])},[e("span",null,n(l(i)(t.number)),1)],2),e("div",Ce,[e("span",null,n(t.name),1)]),d<N.length-1?(r(),a("div",{key:0,class:f(["step-line",{"line-active":d+1<u.value}])},null,2)):p("",!0)])),64))])]),e("div",we,[u.value===1?(r(),a("div",$e,[s[12]||(s[12]=e("h2",null,"سبد خرید",-1)),e("div",Se,[(r(!0),a(h,null,g(S.value.cart.items,t=>(r(),a("div",{key:t.id,class:"item-card"},[e("div",Pe,[e("img",{src:t.product.image?`${l(B).public.API_BASE_URL}${t.product.image.path}`:"/default-product-image.jpg",alt:t.product.name},null,8,Oe)]),e("div",Ae,[e("div",Ne,n(t.product.name),1),e("div",Fe,"قیمت:"+n(l(i)(l(_)(t.product.price))),1),e("div",Ie,"تعداد:"+n(l(i)(t.quantity)),1)]),e("div",Ue,[ge(O,{to:`/product/${t.product.id}`},{default:ye(()=>s[11]||(s[11]=[e("button",{class:"product-info-btn"},"اطلاعات محصول",-1)])),_:2},1032,["to"]),e("button",{onClick:d=>X(t.product.id),class:"rm-item-card-btn"},"حذف از سبد خرید",8,qe)])]))),128))]),e("div",Ee,[e("button",{onClick:s[0]||(s[0]=()=>{Y(),k()})},"ثبت آدرس")])])):p("",!0),u.value===2?(r(),a("div",Le,[s[16]||(s[16]=e("h2",null,"ثبت آدرس",-1)),e("div",Me,[e("div",Be,[(r(!0),a(h,null,g(R.value,t=>(r(),a("div",{key:t.id,class:f(["address-card",{selected:P.value===t.id}]),onClick:d=>P.value=t.id},[e("div",Ve,[e("h3",null,n(l(i)(t.street)),1),e("p",null,n(t.city)+", "+n(t.state)+", "+n(t.country),1)]),e("div",We,[e("button",{onClick:G(d=>ee(t.id),["stop"]),class:"edit-address-btn"},s[13]||(s[13]=[e("i",{class:"fas fa-edit"},null,-1),y(" ویرایش ")]),8,je),e("button",{onClick:G(d=>te(t.id),["stop"]),class:"select-address-btn"},s[14]||(s[14]=[e("i",{class:"fas fa-check-circle"},null,-1),y(" انتخاب ")]),8,xe)])],10,Re))),128)),e("div",{class:"add-address-card",onClick:se},s[15]||(s[15]=[e("div",{class:"add-address-icon"},[e("i",{class:"fas fa-plus"},"+")],-1),e("p",null,"افزودن آدرس جدید",-1)]))])]),e("div",De,[e("button",{onClick:s[1]||(s[1]=()=>{Z(),oe(),k()})},"ثبت روش ارسال"),e("button",{onClick:$},"برگشت به سبد خرید")])])):p("",!0),u.value===3?(r(),a("div",Je,[s[17]||(s[17]=e("h2",null,"نوع ارسال",-1)),e("div",Te,[e("div",ze,[(r(!0),a(h,null,g(W.value,t=>(r(),a("div",{key:t.id,class:f(["shipping-card",{selected:b.value===t.id}]),onClick:d=>b.value=t.id},[e("label",null,[q(e("input",{type:"radio",value:t.id,"onUpdate:modelValue":s[2]||(s[2]=d=>b.value=d),required:"",hidden:""},null,8,He),[[E,b.value]]),e("h3",null,n(t.name),1),e("p",null,n(l(i)(t.description)),1),e("p",null,"هزینه : "+n(l(i)(t.cost)),1),e("p",null,"مدت زمان تحویل :"+n(l(i)(t.delivery_time)),1),b.value===t.id?(r(),a("span",Ke,"✓")):p("",!0)])],10,Ge))),128))]),e("div",Qe,[e("button",{onClick:s[3]||(s[3]=()=>{ne().then(ae).then(le).then(k).catch(t=>console.error(t))})},"صدور فاکتور "),e("button",{onClick:$},"برگشت به انتخاب آدرس")])])])):p("",!0),u.value===4?(r(),a("div",Xe,[s[29]||(s[29]=e("h2",null,"صدور فاکتور",-1)),e("div",Ye,[F.value?(r(),a("div",Ze," Loading...")):p("",!0),e("div",et,[e("div",tt,[s[23]||(s[23]=e("div",{class:"store-details"},[e("h2",null,"فروشگاه ایرانی")],-1)),e("div",st,[e("p",null,[s[18]||(s[18]=e("strong",null,"شماره فاکتور:",-1)),y(" "+n(l(i)(m.value.invoice_number)),1)]),e("p",null,[s[19]||(s[19]=e("strong",null,"تاریخ:",-1)),y(" "+n(l(i)(l(M)(m.value.created_at))),1)]),e("p",null,[s[20]||(s[20]=e("strong",null,"خریدار:",-1)),y(" "+n(I.value.name),1)]),e("p",null,[s[21]||(s[21]=e("strong",null,"تلفن:",-1)),y(" "+n(l(i)("058-362-10992")),1)]),e("p",null,[s[22]||(s[22]=e("strong",null,"پست الکترونیکی:",-1)),y(" "+n(I.value.email),1)])])]),e("div",ot,[e("table",null,[s[25]||(s[25]=e("thead",null,[e("tr",null,[e("th",null,"#"),e("th",null,"تصویر"),e("th",null,"محصول"),e("th",null,"تعداد"),e("th",null,"قیمت"),e("th",null,"مجموع"),e("th",null,"تخفیف"),e("th",null,"قیمت نهایی")])],-1)),e("tbody",null,[(r(!0),a(h,null,g(m.value.items,(t,d)=>(r(),a("tr",{key:d},[e("td",null,n(d+1),1),e("td",null,[e("img",{src:t.product.image?`${l(B).public.API_BASE_URL}${t.product.image.path}`:"/default-product-image.jpg",alt:t.product.name,class:"product-image"},null,8,nt)]),e("td",null,n(t.product.name),1),e("td",null,n(l(i)(t.quantity)),1),e("td",null,n(l(i)(l(_)(t.price))),1),e("td",null,n(l(i)(l(_)(t.total))),1),e("td",null,n(l(i)(l(_)(t.discount))),1),e("td",null,n(l(i)(l(_)(t.price_with_discount))),1)]))),128)),m.value.items.length?p("",!0):(r(),a("tr",lt,s[24]||(s[24]=[e("td",{colspan:"8"},"محصولی موجود نیست",-1)])))])])]),e("div",at,[e("div",null,[s[26]||(s[26]=e("span",null,"جمع کل:",-1)),e("strong",null,n(l(i)(l(_)(m.value.sub_total_amount))),1)]),e("div",null,[e("span",null,"مالیات ("+n(l(i)(l(_)(m.value.tax_rate)))+"%):",1),e("strong",null,n(l(i)(l(_)(m.value.tax))),1)]),e("div",null,[s[27]||(s[27]=e("span",null,"هزینه ارسال:",-1)),e("strong",null,n(l(i)(l(_)(m.value.shipping_cost))),1)]),e("div",rt,[s[28]||(s[28]=e("span",null,"مجموع کل:",-1)),e("strong",null,n(l(i)(l(_)(m.value.total_amount))),1)])])])]),e("div",it,[e("button",{onClick:s[4]||(s[4]=()=>{re().then(k).catch(t=>console.error(t))})},"انتخاب روش پرداخت "),e("button",{onClick:$},"برگست به روش ارسال")])])):p("",!0),u.value===5?(r(),a("div",dt,[s[31]||(s[31]=e("h2",null,"انتخاب روش پرداخت",-1)),e("div",ct,[e("div",ut,[(r(!0),a(h,null,g(j.value,t=>(r(),a("div",{key:t.id,class:f(["payment-card",{selected:C.value===t.id}]),onClick:d=>C.value=t.id},[e("label",null,[q(e("input",{type:"radio",value:t.id,"onUpdate:modelValue":s[5]||(s[5]=d=>C.value=d),required:"",hidden:""},null,8,pt),[[E,C.value]]),e("div",_t,[e("h3",null,n(H(t.name)),1),e("img",{src:t.image?`${o.$config.public.API_BASE_URL}${t.image.path}`:"/default-payment-image.jpg",alt:t.name},null,8,mt)]),e("p",null,n(K(t.name)),1),e("p",null,[s[30]||(s[30]=y("فعال/غیرفعال : ")),t.is_active===1?(r(),a("span",ht,"فعال")):(r(),a("span",gt,"غیرفعال"))]),C.value===t.id?(r(),a("span",yt,"✓")):p("",!0)])],10,vt))),128))])]),e("div",ft,[e("button",{onClick:s[6]||(s[6]=()=>{ie().then(k).catch(t=>console.error(t))})},"انتخاب درگاه پرداخت "),e("button",{onClick:$},"برگشت به صدور فاکتور")])])):p("",!0),u.value===6&&U.value==="Online"?(r(),a("div",kt,[e("div",bt,[s[32]||(s[32]=e("h2",null,"انتخاب درگاه پرداخت",-1)),e("div",Ct,[e("div",wt,[(r(!0),a(h,null,g(x.value,t=>(r(),a("div",{key:t.id,class:f(["online-card",{selected:w.value===t.id}]),onClick:d=>w.value=t.id},[q(e("input",{type:"radio",value:t.id,"onUpdate:modelValue":s[7]||(s[7]=d=>w.value=d),required:"",hidden:""},null,8,St),[[E,w.value]]),e("h3",null,n(t.gateway),1),e("img",{src:t.image?`${o.$config.public.API_BASE_URL}${t.image.path}`:"/default-payment-image.jpg",alt:t.name},null,8,Pt),w.value===t.id?(r(),a("span",Ot,"✓")):p("",!0)],10,$t))),128))]),e("div",At,[e("button",{onClick:s[8]||(s[8]=()=>{D().then(k).catch(t=>console.error(t))})},"اتصال به درگاه "),e("button",{onClick:$},"برگشت به انتخاب روش پرداخت")])])])])):u.value===6&&U.value==="Offline"?(r(),a("div",Nt,[e("div",Ft,[s[37]||(s[37]=e("h2",null,"انتخاب درگاه پرداخت",-1)),e("div",It,[e("div",Ut,[s[34]||(s[34]=e("div",null,[e("p",null,"کیف پول")],-1)),e("div",{class:f(["wallet-card",{selected:z.value===A.value.id}]),onClick:s[9]||(s[9]=t=>z.value=A.value.id)},[s[33]||(s[33]=e("span",null,"موجودی: ",-1)),e("strong",null,n(l(i)(l(_)(A.value.balance)))+" تومان",1)],2)]),e("div",qt,[s[36]||(s[36]=e("p",null,"کارت های اعتباری",-1)),(r(!0),a(h,null,g(J.value,t=>(r(),a("div",{key:t.id,class:f(["coupon-card",{selected:T.value===t.id}]),onClick:d=>T.value=t.id},[e("div",Lt,[e("div",Mt,n(l(i)(t.code)),1),e("div",Bt,"تاریخ اعتبار: "+n(l(i)(l(M)(t.created_at))),1)]),e("div",Rt,[e("p",null,"تخفیف : "+n(l(i)(t.discount_amount))+" "+n(t.discount_type),1),e("p",null,"توضیحات : "+n(t.description),1)]),e("div",Vt,[e("div",Wt,n(t.is_used?"استفاده شده":"اعتبار دارد"),1),s[35]||(s[35]=e("div",{class:"coupon-actions"},[e("a",{href:"#"},"Use Coupon")],-1))])],10,Et))),128))]),e("div",jt,[e("button",{onClick:s[10]||(s[10]=()=>{D().then(k).catch(t=>console.error(t))})},"پرداخت سفارش "),e("button",{onClick:$},"برگشت به انتخاب روش پرداخت")])])])])):p("",!0)])],64)}}},zt=pe(xt,[["__scopeId","data-v-994ccca6"]]);export{zt as default};
