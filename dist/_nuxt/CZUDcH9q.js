import{_ as x,u as y,M as b,f as U,g as v,c as k,a,h as r,v as n,t as l,i as R,o as S}from"./C6qXNm8V.js";const T={class:"body"},C={class:"avatar-preview"},A=["src"],V="Enter a name.",D="Enter a unique username.",E="Enter your email address.",H="Choose a strong password.",I="Repeat the password for confirmation.",P={__name:"register",setup(F){const{$axios:p}=y(),i=b(),f=U(),u=v(null),t=v({name:"",username:"",email:"",password:"",password_confirmation:""}),w=o=>{const e=o.target.files[0];if(e){const s=new FileReader;s.onload=d=>{u.value=d.target.result},s.readAsDataURL(e)}},g=()=>{document.querySelector("#avatar").click()},c=async()=>{try{const o=new FormData;o.append("name",t.value.name),o.append("username",t.value.username),o.append("email",t.value.email),o.append("password",t.value.password),o.append("password_confirmation",t.value.password_confirmation);const e=document.querySelector("#avatar").files[0];e&&o.append("image",e);const s=await p.post("user/create",o,{headers:{"Content-Type":"multipart/form-data"}});if(console.log(s.data),s.data){alert("Registration successful!");const d=await p.post("user/login",{email:t.value.email,password:t.value.password}),m=s.data.token;i.setToken(m),localStorage.setItem("auth_token",i.token),console.log(i.token),console.log("Login successful:",m),await f.push("/")}else alert("Registration failed: "+s.data.message)}catch(o){console.error("Registration failed:",o),alert("An error occurred during registration. Please try again.")}};return(o,e)=>(S(),k("div",T,[a("form",{onSubmit:R(c,["prevent"]),enctype:"multipart/form-data"},[e[12]||(e[12]=a("h2",null,"User Register Form",-1)),a("div",C,[a("img",{src:u.value||"/default-avatar.png",alt:"avatar Preview",onClick:g},null,8,A)]),a("p",null,[e[5]||(e[5]=a("label",{for:"avatar"},"Upload avatar",-1)),a("input",{type:"file",id:"avatar",ref:"avatarInput",onChange:w,accept:"image/*"},null,544),e[6]||(e[6]=a("span",{class:"help-text"},"Choose an image file for your avatar.",-1))]),a("p",null,[e[7]||(e[7]=a("label",{for:"name"},"Name",-1)),r(a("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=s=>t.value.name=s)},null,512),[[n,t.value.name]]),a("span",{class:"help-text"},l(V))]),a("p",null,[e[8]||(e[8]=a("label",{for:"username"},"Username",-1)),r(a("input",{type:"text",id:"username","onUpdate:modelValue":e[1]||(e[1]=s=>t.value.username=s)},null,512),[[n,t.value.username]]),a("span",{class:"help-text"},l(D))]),a("p",null,[e[9]||(e[9]=a("label",{for:"email"},"Email",-1)),r(a("input",{type:"email",id:"email","onUpdate:modelValue":e[2]||(e[2]=s=>t.value.email=s)},null,512),[[n,t.value.email]]),a("span",{class:"help-text"},l(E))]),a("p",null,[e[10]||(e[10]=a("label",{for:"password"},"Password",-1)),r(a("input",{type:"password",id:"password","onUpdate:modelValue":e[3]||(e[3]=s=>t.value.password=s)},null,512),[[n,t.value.password]]),a("span",{class:"help-text"},l(H))]),a("p",null,[e[11]||(e[11]=a("label",{for:"password2"},"Confirm Password",-1)),r(a("input",{type:"password",id:"password_confirmation","onUpdate:modelValue":e[4]||(e[4]=s=>t.value.password_confirmation=s)},null,512),[[n,t.value.password_confirmation]]),a("span",{class:"help-text"},l(I))]),e[13]||(e[13]=a("button",{type:"submit"},"Save",-1))],32)]))}},B=x(P,[["__scopeId","data-v-1b74074f"]]);export{B as default};
