import{u as h,r as y,j as b,c as n,b as k,a as o,F as c,k as m,o as r,m as R,x as $,y as x,t as d,n as B}from"./k-3Yaxe7.js";import{_ as C}from"./DlAUqK2U.js";const L={class:"container"},S={class:"user-list"},A=["src","alt"],E={class:"user-info-admin"},F={class:"user-name"},N={class:"user-email"},w={class:"roles-container"},I=["onClick","disabled"],M={key:0},U={key:1},V={__name:"users-management",setup(j){const{$axios:u}=h(),l=y([]),p=x();function g(s){return s.map(t=>({name:t,active:!0,loading:!1}))}async function f(){try{const s=await u.get("user/users/list");l.value=s.data.users_list.map(t=>({...t,roles:g(t.roles)}))}catch(s){console.error("Fetch users list error:",s.response?s.response.data:s)}}async function v(s,t){const i=l.value.find(e=>e.email===s);if(i){const e=i.roles[t];if(e){e.loading=!0;try{const a=await u.post(`permissionRoleSetting/toggleRoles/${s}`,{role:e.name});a.data.success?e.active=!e.active:console.error("Error toggling role:",a.data.message)}catch(a){console.error("Toggle role error:",a.response?a.response.data:a)}finally{e.loading=!1}}}}return b(()=>{f()}),(s,t)=>{const i=R;return r(),n(c,null,[k(i),o("div",L,[t[0]||(t[0]=o("h1",{class:"header"},"لیست کاربران",-1)),o("div",S,[(r(!0),n(c,null,m(l.value,e=>(r(),n("div",{key:e.id,class:"user-card"},[o("img",{src:e.image?`${$(p).public.API_BASE_URL}${e.image.path}`:"/default-avatar.png",alt:e.name,class:"user-avatar-admin"},null,8,A),o("div",E,[o("h2",F,d(e.name),1),o("p",N,d(e.email),1),o("div",w,[(r(!0),n(c,null,m(e.roles,(a,_)=>(r(),n("button",{key:_,class:B(["role-button",a.active?"role-active":"role-inactive"]),onClick:z=>v(e.email,_),disabled:a.loading},[a.loading?(r(),n("span",U,"در حال بارگزاری ...")):(r(),n("span",M,d(a.name),1))],10,I))),128))])])]))),128))])])],64)}}},T=C(V,[["__scopeId","data-v-bbed2ab4"]]);export{T as default};
